Домашнее задание OOP Reducer
============================

Требуется написать классы для проведения над логами операции [схлопывания](https://en.wikipedia.org/wiki/Fold_(higher-order_function)) (reduce).

Reducer
-------

Каждый такой класс называется `Reducer` и должен отличаться от абстрактного базового класса лишь методом `_reduce`, который задает правило схлопывания.

Параметры конструктора:
* `source` — объект, выдающий строки из лога (см. ниже);
* `row_class` — имя класса, с помощью которого создаются объекты из каждой строки логов (см. ниже);
* `initial_value` — инициализационое значение для операции схлопывания.

Методы:
* `reduce_n($n)` — схлопнуть очередные `$n` строк, вернуть промежуточный результат.
* `reduce_all()` — схлопнуть всё, вернуть результат.
* `reduced` — промежуточный результат.

Минимум надо реализовать:
* `Reducer` — базовый абстрактный класс.
* `Reducer::SumPrice` — суммирует значение полей `price` каждой строки лога.
* `Reducer::MaxDiff` — выясняем максимальную разницу между полями `top` и `bottom` среди всех строк лога.

Source
------

Класс, объекты которого отвечают за подачу данных в `Reducer`. 

Методы:
* `next` — возвращает очередную строку или `undef`, если лог исчерпан.

Минимум надо реализовать:
* `Source::Array` — отдает поэлементно массив, который передается в конструктор параметром `array`.
* `Source::FileHandler` — отдает построчно содержимое файла, дескриптор которого передается в конструктор в параметре `fh`.

Row
---

Класс, объекты которого отвечают за парсинг строк из источника. Формат логов может быть разным, для каждого нужен свой подкласс `Row`.

Параметры конструктора:
* `str` — строка из источника.

Методы:
* `get($name, $default)` — возвращает значение поля `$name` строки лога или `$default`, если таковое отсутствует.

Минимум надо реализовать:
* `Row::Simple` — каждая строка — набор пар `ключ:значение`, соединенных запятой. В ключах и значениях не может быть двоеточий и запятых.
* `Row::JSON` — каждая строка — JSON.
* `Row::XML` — каждая строка — XML.


Пример
------

```perl
my $reducer = Local::Reducer::SumPrice->new(
    source => Local::Source::Array->new(array => [
        '{"price": 1}',
        '{"price": 2}',
        '{"price": 3}',
    ]),
    row_class => 'Local::Row::JSON',
    initial_value => 0,
);
```
Этот прмиер создает редьюсер, который посчитает сумму по полям `price` всех строк лога. Сам лог — это массив JSON-ов. `$reducer->reduce_all()` вернет 6.
